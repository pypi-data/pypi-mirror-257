const DEBUG="true"==document.body.dataset.debug,BASE_SITE_URL=window.location.protocol+"//"+window.location.hostname+("http:"==window.location.protocol&&80==window.location.port||"https:"==window.location.protocol&&443==window.location.port?"":":"+window.location.port),BASE_STATIC_PATH=document.body.dataset.staticPrefix?document.body.dataset.staticPrefix.replace(/\/$/,""):"/static",BASE_MEDIA_PATH=document.body.dataset.mediaPrefix?document.body.dataset.mediaPrefix.replace(/\/$/,""):"/media",breakpoint={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400};function fromHTML(e){var t=document.createElement("template"),e=(t.innerHTML=e,t.content.children);return 1==e.length?e[0]:e}function submitLoading(e,{data:t,url:s,onSuccess:a}={}){var o=new FormData(e);for(const l in t)o.set(l,t[l]);s=s||e.getAttribute("action");const n=e.querySelector('button[type="submit"]'),r=n.innerHTML;n.innerHTML='<span class="spinner-border spinner-border-sm" aria-hidden="true"></span><span class="visually-hidden" role="status">Loading...</span>',n.disabled=!0,fetch(s,{method:"post",body:o}).then(t=>{t.text().then(e=>{messages.add(t.status<300?"SUCCESS":"ERROR",e),a&&t.status<300&&a()}).catch(e=>messages.error(e))}).catch(e=>{messages.error(e)}).finally(()=>{n.innerHTML=r,n.disabled=!1})}function isToday(e){var t;return!!e&&(t=new Date,e.getDate()==t.getDate())&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()}const formatters={int(e){return null==e||""===e?e:parseInt(e).toLocaleString()},date(e){var t,s,a;return e&&(s=(t=new Date(e)).toLocaleString(),"1"==localStorage.getItem("settings-fulldate")||(a=s.indexOf(" "))<=0?s:isToday(t)?`<span title="${s}">${s.substring(a+1)}</span>`:`<span title="${s}">${s.substring(0,a)}</span>`)},link(e,t){return e&&t._data.link?`<a href="${t._data.link}">${e}</a>`:e},following(e,t,s,a){return"number"!=typeof a?(console.error("cannot use following formatter with non-numeric field: "+a),e):(t=t[a+1])&&t.replace(/{value}/g,e)}};function initBootstrapTable(s,{fields:e,sortName:t,sortOrder:a,pageSize:o,columns:n,...r}={}){var l,i,d=document.getElementById(s),c=(void 0===r.pagination&&(r.pagination=!0),void 0===r.search&&(r.search=!0),void 0===r.toolbar&&(r.toolbar=`#${s}-toolbar`),r.sortName=localStorage.getItem(`bt-${s}-sortName`)??t??"name",r.sortOrder=localStorage.getItem(`bt-${s}-sortOrder`)??a??"asc",r.onSort=(e,t)=>{localStorage.setItem(`bt-${s}-sortName`,e),localStorage.setItem(`bt-${s}-sortOrder`,t)},r.pageSize=localStorage.getItem(`bt-${s}-pageSize`)??o??25,r.onPageChange=(e,t)=>{localStorage.setItem(`bt-${s}-pageSize`,t)},void 0===n&&(n=[]),{});for([l,i]of d.tHead.querySelectorAll("th").entries()){var m=i.dataset.field;m&&(c[m]=l),n.length<l+1&&n.push({})}for(const b of n)void 0===b.sortable&&(b.sortable=!0);if(e)for(var[g,u]of Object.entries(e)){var f=c[g];void 0===f?console.error(`${s}: ignore column configuration for field "${g}": field not found in thead`):n[f]={...n[f],...u}}return $("#"+s).bootstrapTable({columns:n,...r})}const _messages=document.getElementById("messages");let _messagesCloseAll,_messagesContent,_messagesFixedAfter;const messages={add(e,t){let s="primary";if(e)switch(e.toUpperCase()){case"DEBUG":s="secondary";break;case"INFO":s="info";break;case"SUCCESS":s="success";break;case"WARNING":s="warning";break;case"ERROR":s="danger"}e=fromHTML(`<div class="alert alert-${s} alert-dismissible fade show" role="alert">${t}<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>`);return _messagesContent.appendChild(e),0<_messagesFixedAfter&&window.scrollY>_messagesFixedAfter&&_messages.classList.add("fixed-messages"),e},clear(){for(;_messagesContent.firstChild;)_messagesContent.removeChild(_messagesContent.lastChild);_messagesCloseAll&&_messagesCloseAll.classList.add("d-none")},debug(e){return this.add("DEBUG",e)},info(e){return this.add("INFO",e)},success(e){return this.add("SUCCESS",e)},warning(e){return this.add("WARNING",e)},error(e){return this.add("ERROR",e)}};function _onUpdate(){2<=_messagesContent.childElementCount?_messagesCloseAll.classList.remove("d-none"):(_messagesCloseAll.classList.add("d-none"),0<_messagesFixedAfter&&0==_messagesContent.childElementCount&&_messages.classList.remove("fixed-messages"))}_messages&&(_messagesFixedAfter=parseInt(document.body.dataset.messagesFixedAfter??75),_messagesContent=document.getElementById("messages-content")??_messages,_messagesCloseAll=document.getElementById("messages-close-all"))&&(_messagesCloseAll.querySelector("a").addEventListener("click",e=>{e.preventDefault(),messages.clear()}),new MutationObserver(_onUpdate).observe(_messagesContent,{childList:!0}),_onUpdate());export{DEBUG,BASE_SITE_URL,BASE_STATIC_PATH,BASE_MEDIA_PATH,breakpoint,fromHTML,submitLoading,isToday,formatters,initBootstrapTable,messages};
//# sourceMappingURL=commons.min.js.map