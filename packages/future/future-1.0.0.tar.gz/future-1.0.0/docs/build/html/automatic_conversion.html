
<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Automatic conversion to Py2/3 &#8212; Python-Future  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/jinja.css?v=85659ec6" />
    <link rel="stylesheet" href="_static/my-styles.css" type="text/css" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="_static/python-future-icon-32.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Frequently Asked Questions (FAQ)" href="faq.html" />
    <link rel="prev" title="What else you need to know" href="what_else.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-19344199-2']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently Asked Questions (FAQ)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="what_else.html" title="What else you need to know"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python-Future  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Automatic conversion to Py2/3</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="automatic-conversion-to-py2-3">
<span id="automatic-conversion"></span><h1>Automatic conversion to Py2/3<a class="headerlink" href="#automatic-conversion-to-py2-3" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">future</span></code> source tree includes scripts called <code class="docutils literal notranslate"><span class="pre">futurize</span></code> and
<code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> to aid in making Python 2 code or Python 3 code compatible with
both platforms (Py2/3) using the <code class="xref py py-mod docutils literal notranslate"><span class="pre">future</span></code> module. These are based on
<code class="docutils literal notranslate"><span class="pre">lib2to3</span></code> and use fixers from <code class="docutils literal notranslate"><span class="pre">2to3</span></code>, <code class="docutils literal notranslate"><span class="pre">3to2</span></code>, and <code class="docutils literal notranslate"><span class="pre">python-modernize</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">futurize</span></code> passes Python 2 code through all the appropriate fixers to turn it
into valid Python 3 code, and then adds <code class="docutils literal notranslate"><span class="pre">__future__</span></code> and <code class="docutils literal notranslate"><span class="pre">future</span></code> package
imports.</p>
<p>For conversions from Python 3 code to Py2/3, use the <code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> script
instead. This converts Py3-only constructs (e.g. new metaclass syntax) and adds
<code class="docutils literal notranslate"><span class="pre">__future__</span></code> and <code class="docutils literal notranslate"><span class="pre">future</span></code> imports to the top of each module.</p>
<p>In both cases, the result should be relatively clean Py3-style code that runs
mostly unchanged on both Python 2 and Python 3.</p>
<section id="futurize-py2-to-py2-3">
<span id="forwards-conversion"></span><h2><code class="docutils literal notranslate"><span class="pre">futurize</span></code>: Py2 to Py2/3<a class="headerlink" href="#futurize-py2-to-py2-3" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">futurize</span></code> script passes Python 2 code through all the appropriate fixers
to turn it into valid Python 3 code, and then adds <code class="docutils literal notranslate"><span class="pre">__future__</span></code> and
<code class="docutils literal notranslate"><span class="pre">future</span></code> package imports to re-enable compatibility with Python 2.</p>
<p>For example, running <code class="docutils literal notranslate"><span class="pre">futurize</span></code> turns this Python 2 code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ConfigParser</span>                 <span class="c1"># Py2 module name</span>

<span class="k">class</span> <span class="nc">Upper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>                 <span class="c1"># Py2-style iterator interface</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<span class="n">itr</span> <span class="o">=</span> <span class="n">Upper</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="nb">next</span><span class="p">(</span><span class="n">itr</span><span class="p">),</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">itr</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">letter</span><span class="p">,</span>                   <span class="c1"># Py2-style print statement</span>
</pre></div>
</div>
<p>into this code which runs on both Py2 and Py3:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="kn">import</span> <span class="nb">next</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="kn">import</span> <span class="nb">object</span>
<span class="kn">import</span> <span class="nn">configparser</span>                 <span class="c1"># Py3-style import</span>

<span class="k">class</span> <span class="nc">Upper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterable</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_iter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>             <span class="c1"># Py3-style iterator interface</span>
        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<span class="n">itr</span> <span class="o">=</span> <span class="n">Upper</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">itr</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>           <span class="c1"># Py3-style print function</span>
<span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">itr</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">letter</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To write out all the changes to your Python files that <code class="docutils literal notranslate"><span class="pre">futurize</span></code> suggests,
use the <code class="docutils literal notranslate"><span class="pre">-w</span></code> flag.</p>
<p>For complex projects, it is probably best to divide the porting into two stages.
Stage 1 is for “safe” changes that modernize the code but do not break Python
2.7 compatibility or introduce a dependency on the <code class="docutils literal notranslate"><span class="pre">future</span></code> package. Stage 2
is to complete the process.</p>
<section id="stage-1-safe-fixes">
<span id="forwards-conversion-stage1"></span><h3>Stage 1: “safe” fixes<a class="headerlink" href="#stage-1-safe-fixes" title="Link to this heading">¶</a></h3>
<p>Run the first stage of the conversion process with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage1</span> <span class="n">mypackage</span><span class="o">/*.</span><span class="n">py</span>
</pre></div>
</div>
<p>or, if you are using zsh, recursively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage1</span> <span class="n">mypackage</span><span class="o">/**/*.</span><span class="n">py</span>
</pre></div>
</div>
<p>This applies fixes that modernize Python 2 code without changing the effect of
the code. With luck, this will not introduce any bugs into the code, or will at
least be trivial to fix. The changes are those that bring the Python code
up-to-date without breaking Py2 compatibility. The resulting code will be
modern Python 2.7-compatible code plus <code class="docutils literal notranslate"><span class="pre">__future__</span></code> imports from the
following set:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</pre></div>
</div>
<p>Only those <code class="docutils literal notranslate"><span class="pre">__future__</span></code> imports deemed necessary will be added unless
the <code class="docutils literal notranslate"><span class="pre">--all-imports</span></code> command-line option is passed to <code class="docutils literal notranslate"><span class="pre">futurize</span></code>, in
which case they are all added.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">unicode_literals</span></code> declaration is not added
unless the <code class="docutils literal notranslate"><span class="pre">--unicode-literals</span></code> flag is passed to <code class="docutils literal notranslate"><span class="pre">futurize</span></code>.</p>
<p>The changes include:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="k">except</span> <span class="n">MyException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
<span class="o">+</span> <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="o">-</span> <span class="nb">print</span> <span class="o">&gt;&gt;</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;Blah&quot;</span>
<span class="o">+</span> <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="o">+</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Blah&quot;</span><span class="p">,</span> <span class="n">stderr</span><span class="p">)</span>

<span class="o">-</span> <span class="k">class</span> <span class="nc">MyClass</span><span class="p">:</span>
<span class="o">+</span> <span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="o">-</span> <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">+</span> <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="o">-</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="o">+</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
</pre></div>
</div>
<p>Implicit relative imports fixed, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="kn">import</span> <span class="nn">mymodule</span>
<span class="o">+</span> <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
<span class="o">+</span> <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">mymodule</span>
</pre></div>
</div>
<p>Stage 1 does not add any imports from the <code class="docutils literal notranslate"><span class="pre">future</span></code> package. The output of
stage 1 will probably not (yet) run on Python 3.</p>
<p>The goal for this stage is to create most of the <code class="docutils literal notranslate"><span class="pre">diff</span></code> for the entire
porting process, but without introducing any bugs. It should be uncontroversial
and safe to apply to every Python 2 package. The subsequent patches introducing
Python 3 compatibility should then be shorter and easier to review.</p>
<p>The complete set of fixers applied by <code class="docutils literal notranslate"><span class="pre">futurize</span> <span class="pre">--stage1</span></code> is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_apply</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_except</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_exec</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_exitfunc</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_funcattrs</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_has_key</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_idioms</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_intern</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_isinstance</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_methodattrs</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_ne</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_numliterals</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_paren</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_reduce</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_renames</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_repr</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_standarderror</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_sys_exc</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_throw</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_tuple_params</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_types</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_ws_comma</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_xreadlines</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_absolute_import</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_next_call</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_print_with_import</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_raise</span>
</pre></div>
</div>
<p>The following fixers from <code class="docutils literal notranslate"><span class="pre">lib2to3</span></code> are not applied:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_import</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fix_absolute_import</span></code> fixer in <code class="docutils literal notranslate"><span class="pre">libfuturize.fixes</span></code> is applied instead of
<code class="docutils literal notranslate"><span class="pre">lib2to3.fixes.fix_import</span></code>. The new fixer both makes implicit relative
imports explicit and adds the declaration <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span>
<span class="pre">absolute_import</span></code> at the top of each relevant module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_next</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fix_next_call</span></code> fixer in <code class="docutils literal notranslate"><span class="pre">libfuturize.fixes</span></code> is applied instead of
<code class="docutils literal notranslate"><span class="pre">fix_next</span></code> in stage 1. The new fixer changes any <code class="docutils literal notranslate"><span class="pre">obj.next()</span></code> calls to
<code class="docutils literal notranslate"><span class="pre">next(obj)</span></code>, which is Py2/3 compatible, but doesn’t change any <code class="docutils literal notranslate"><span class="pre">next</span></code> method
names to <code class="docutils literal notranslate"><span class="pre">__next__</span></code>, which would break Py2 compatibility.</p>
<p><code class="docutils literal notranslate"><span class="pre">fix_next</span></code> is applied in stage 2.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_print</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fix_print_with_import</span></code> fixer in <code class="docutils literal notranslate"><span class="pre">libfuturize.fixes</span></code> changes the code to
use print as a function and also adds <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span>
<span class="pre">print_function</span></code> to the top of modules using <code class="docutils literal notranslate"><span class="pre">print()</span></code>.</p>
<p>In addition, it avoids adding an extra set of parentheses if these already
exist. So <code class="docutils literal notranslate"><span class="pre">print(x)</span></code> does not become <code class="docutils literal notranslate"><span class="pre">print((x))</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_raise</span>
</pre></div>
</div>
<p>This fixer translates code to use the Python 3-only <code class="docutils literal notranslate"><span class="pre">with_traceback()</span></code>
method on exceptions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_set_literal</span>
</pre></div>
</div>
<p>This converts <code class="docutils literal notranslate"><span class="pre">set([1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>) to <code class="docutils literal notranslate"><span class="pre">{1,</span> <span class="pre">2,</span> <span class="pre">3}</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_ws_comma</span>
</pre></div>
</div>
<p>This performs cosmetic changes. This is not applied by default because it
does not serve to improve Python 2/3 compatibility. (In some cases it may
also reduce readability: see issue #58.)</p>
</section>
<section id="stage-2-py3-style-code-with-wrappers-for-py2">
<span id="forwards-conversion-stage2"></span><h3>Stage 2: Py3-style code with wrappers for Py2<a class="headerlink" href="#stage-2-py3-style-code-with-wrappers-for-py2" title="Link to this heading">¶</a></h3>
<p>Run stage 2 of the conversion process with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage2</span> <span class="n">myfolder</span><span class="o">/*.</span><span class="n">py</span>
</pre></div>
</div>
<p>This stage adds a dependency on the <code class="docutils literal notranslate"><span class="pre">future</span></code> package. The goal for stage 2 is
to make further mostly safe changes to the Python 2 code to use Python 3-style
code that then still runs on Python 2 with the help of the appropriate builtins
and utilities in <code class="docutils literal notranslate"><span class="pre">future</span></code>.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;What is your name?</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;My object&#39;</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">unicode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>would be converted by Stage 2 to this code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">input</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">str</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">iteritems</span><span class="p">,</span> <span class="n">python_2_unicode_compatible</span>

<span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;What is your name?</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">))</span>

<span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;My object&#39;</span>
</pre></div>
</div>
<p>Stage 2 also renames standard-library imports to their Py3 names and adds these
two lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ConfigParser</span>
</pre></div>
</div>
<p>becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">configparser</span>
</pre></div>
</div>
<p>The complete list of fixers applied in Stage 2 is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_dict</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_filter</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_getcwdu</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_input</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_itertools</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_itertools_imports</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_long</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_map</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_next</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_nonzero</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_operator</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_raw_input</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_zip</span>

<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_basestring</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_cmp</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_division_safe</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_execfile</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_future_builtins</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_future_standard_library</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_future_standard_library_urllib</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_metaclass</span>
<span class="n">libpasteurize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_newstyle</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_object</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_unicode_keep_u</span>
<span class="n">libfuturize</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_xrange_with_import</span>
</pre></div>
</div>
<p>Not applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_buffer</span>    <span class="c1"># Perhaps not safe. Test this.</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_callable</span>  <span class="c1"># Not needed in Py3.2+</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_execfile</span>  <span class="c1"># Some problems: see issue #37.</span>
                            <span class="c1"># We use the custom libfuturize.fixes.fix_execfile instead.</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_future</span>    <span class="c1"># Removing __future__ imports is bad for Py2 compatibility!</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_imports</span>   <span class="c1"># Called by libfuturize.fixes.fix_future_standard_library</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_imports2</span>  <span class="c1"># We don&#39;t handle this yet (dbm)</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_metaclass</span> <span class="c1"># Causes SyntaxError in Py2! Use the one from ``six`` instead</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_unicode</span>   <span class="c1"># Strips off the u&#39;&#39; prefix, which removes a potentially</span>
                            <span class="c1"># helpful source of information for disambiguating</span>
                            <span class="c1"># unicode/byte strings.</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_urllib</span>    <span class="c1"># Included in libfuturize.fix_future_standard_library_urllib</span>
<span class="n">lib2to3</span><span class="o">.</span><span class="n">fixes</span><span class="o">.</span><span class="n">fix_xrange</span>    <span class="c1"># Custom one because of a bug with Py3.3&#39;s lib2to3</span>
</pre></div>
</div>
</section>
<section id="separating-text-from-bytes">
<span id="forwards-conversion-text"></span><h3>Separating text from bytes<a class="headerlink" href="#separating-text-from-bytes" title="Link to this heading">¶</a></h3>
<p>After applying stage 2, the recommended step is to decide which of your Python
2 strings represent text and which represent binary data and to prefix all
string literals with either <code class="docutils literal notranslate"><span class="pre">b</span></code> or <code class="docutils literal notranslate"><span class="pre">u</span></code> accordingly. Furthermore, to ensure
that these types behave similarly on Python 2 as on Python 3, also wrap
byte-strings or text in the <code class="docutils literal notranslate"><span class="pre">bytes</span></code> and <code class="docutils literal notranslate"><span class="pre">str</span></code> types from <code class="docutils literal notranslate"><span class="pre">future</span></code>. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">ABCD&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;This is normal text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any unadorned string literals will then represent native platform strings
(byte-strings on Py2, unicode strings on Py3).</p>
<p>An alternative is to pass the <code class="docutils literal notranslate"><span class="pre">--unicode-literals</span></code> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ futurize --unicode-literals mypython2script.py
</pre></div>
</div>
<p>After running this, all string literals that were not explicitly marked up as
<code class="docutils literal notranslate"><span class="pre">b''</span></code> will mean text (Python 3 <code class="docutils literal notranslate"><span class="pre">str</span></code> or Python 2 <code class="docutils literal notranslate"><span class="pre">unicode</span></code>).</p>
</section>
<section id="post-conversion">
<span id="forwards-conversion-stage3"></span><h3>Post-conversion<a class="headerlink" href="#post-conversion" title="Link to this heading">¶</a></h3>
<p>After running <code class="docutils literal notranslate"><span class="pre">futurize</span></code>, we recommend first running your tests on Python 3 and making further code changes until they pass on Python 3.</p>
<p>The next step would be manually tweaking the code to re-enable Python 2
compatibility with the help of the <code class="docutils literal notranslate"><span class="pre">future</span></code> package. For example, you can add
the <code class="docutils literal notranslate"><span class="pre">&#64;python_2_unicode_compatible</span></code> decorator to any classes that define custom
<code class="docutils literal notranslate"><span class="pre">__str__</span></code> methods. See <a class="reference internal" href="what_else.html#what-else"><span class="std std-ref">What else you need to know</span></a> for more info.</p>
</section>
</section>
<section id="futurize-quick-start-guide">
<span id="futurize-cheatsheet"></span><h2><code class="docutils literal notranslate"><span class="pre">futurize</span></code> quick-start guide<a class="headerlink" href="#futurize-quick-start-guide" title="Link to this heading">¶</a></h2>
<p>How to convert Py2 code to Py2/3 code using <code class="docutils literal notranslate"><span class="pre">futurize</span></code>:</p>
<section id="step-0-setup">
<span id="porting-setup"></span><h3>Step 0: setup<a class="headerlink" href="#step-0-setup" title="Link to this heading">¶</a></h3>
<p>Step 0 goal: set up and see the tests passing on Python 2 and failing on Python 3.</p>
<ol class="loweralpha">
<li><p>Clone the package from github/bitbucket. Optionally rename your repo to <code class="docutils literal notranslate"><span class="pre">package-future</span></code>. Examples: <code class="docutils literal notranslate"><span class="pre">reportlab-future</span></code>, <code class="docutils literal notranslate"><span class="pre">paramiko-future</span></code>, <code class="docutils literal notranslate"><span class="pre">mezzanine-future</span></code>.</p></li>
<li><p>Create and activate a Python 2 conda environment or virtualenv. Install the package with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code> and run its test suite on Py2.7 (e.g. <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span></code> or <code class="docutils literal notranslate"><span class="pre">py.test</span></code>)</p></li>
<li><p>Optionally: if there is a <code class="docutils literal notranslate"><span class="pre">.travis.yml</span></code> file, add Python version 3.6 and remove any versions &lt; 2.6.</p></li>
<li><p>Install Python 3 with e.g. <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">python3</span></code>. On other platforms, an easy way is to use <a class="reference external" href="http://repo.continuum.io/miniconda/index.html">Miniconda</a>. Then e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">py36</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.6</span> <span class="n">pip</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="step-1-modern-py2-code">
<span id="porting-step1"></span><h3>Step 1: modern Py2 code<a class="headerlink" href="#step-1-modern-py2-code" title="Link to this heading">¶</a></h3>
<p>The goal for this step is to modernize the Python 2 code without introducing any dependencies (on <code class="docutils literal notranslate"><span class="pre">future</span></code> or e.g. <code class="docutils literal notranslate"><span class="pre">six</span></code>) at this stage.</p>
<p><strong>1a</strong>. Install <code class="docutils literal notranslate"><span class="pre">future</span></code> into the virtualenv using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">future</span>
</pre></div>
</div>
<p><strong>1b</strong>. Run <code class="docutils literal notranslate"><span class="pre">futurize</span> <span class="pre">--stage1</span> <span class="pre">-w</span> <span class="pre">*.py</span> <span class="pre">subdir1/*.py</span> <span class="pre">subdir2/*.py</span></code>. Note that with
recursive globbing in <code class="docutils literal notranslate"><span class="pre">bash</span></code> or <code class="docutils literal notranslate"><span class="pre">zsh</span></code>, you can apply stage 1 to all source files
recursively with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage1</span> <span class="o">-</span><span class="n">w</span> <span class="o">.</span>
</pre></div>
</div>
<p><strong>1c</strong>. Commit all changes</p>
<p><strong>1d</strong>. Re-run the test suite on Py2 and fix any errors.</p>
<p>See <a class="reference internal" href="futurize.html#forwards-conversion-stage1"><span class="std std-ref">Stage 1: “safe” fixes</span></a> for more info.</p>
<section id="example-error">
<h4>Example error<a class="headerlink" href="#example-error" title="Link to this heading">¶</a></h4>
<p>One relatively common error after conversion is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="o">...</span>
  <span class="n">File</span> <span class="s2">&quot;/home/user/Install/BleedingEdge/reportlab/tests/test_encrypt.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">19</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="kn">from</span> <span class="nn">.test_pdfencryption</span> <span class="kn">import</span> <span class="n">parsedoc</span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="n">Attempted</span> <span class="n">relative</span> <span class="kn">import</span> <span class="nn">in</span> <span class="n">non</span><span class="o">-</span><span class="n">package</span>
</pre></div>
</div>
<p>If you get this error, try adding an empty <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file in the package
directory. (In this example, in the tests/ directory.) If this doesn’t help,
and if this message appears for all tests, they must be invoked differently
(from the cmd line or e.g. <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>). The way to run a module inside a
package on Python 3, or on Python 2 with <code class="docutils literal notranslate"><span class="pre">absolute_import</span></code> in effect, is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">tests</span><span class="o">.</span><span class="n">test_platypus_xref</span>
</pre></div>
</div>
<p>(For more info, see <a class="reference external" href="http://www.python.org/dev/peps/pep-0328/">PEP 328</a> and
the <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">PEP 8</a> section on absolute
imports.)</p>
</section>
</section>
<section id="step-2-working-py3-code-that-still-supports-py2">
<span id="porting-step2"></span><h3>Step 2: working Py3 code that still supports Py2<a class="headerlink" href="#step-2-working-py3-code-that-still-supports-py2" title="Link to this heading">¶</a></h3>
<p>The goal for this step is to get the tests passing first on Py3 and then on Py2
again with the help of the <code class="docutils literal notranslate"><span class="pre">future</span></code> package.</p>
<p><strong>2a</strong>. Run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage2</span> <span class="n">myfolder1</span><span class="o">/*.</span><span class="n">py</span> <span class="n">myfolder2</span><span class="o">/*.</span><span class="n">py</span>
</pre></div>
</div>
<p>You can view the stage 2 changes to all Python source files recursively with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage2</span> <span class="o">.</span>
</pre></div>
</div>
<p>To apply the changes, add the <code class="docutils literal notranslate"><span class="pre">-w</span></code> argument.</p>
<p>This stage makes further conversions needed to support both Python 2 and 3.
These will likely require imports from <code class="docutils literal notranslate"><span class="pre">future</span></code> on Py2 (and sometimes on Py3),
such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>
<span class="c1"># ...</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">bytes</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">open</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">with_metaclass</span>
</pre></div>
</div>
<p>Optionally, you can use the <code class="docutils literal notranslate"><span class="pre">--unicode-literals</span></code> flag to add this import to
the top of each module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
</pre></div>
</div>
<p>All strings in the module would then be unicode on Py2 (as on Py3) unless
explicitly marked with a <code class="docutils literal notranslate"><span class="pre">b''</span></code> prefix.</p>
<p>If you would like <code class="docutils literal notranslate"><span class="pre">futurize</span></code> to import all the changed builtins to have their
Python 3 semantics on Python 2, invoke it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">futurize</span> <span class="o">--</span><span class="n">stage2</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">imports</span> <span class="n">myfolder</span><span class="o">/*.</span><span class="n">py</span>
</pre></div>
</div>
<p><strong>2b</strong>. Re-run your tests on Py3 now. Make changes until your tests pass on Python 3.</p>
<p><strong>2c</strong>. Commit your changes! :)</p>
<p><strong>2d</strong>. Now run your tests on Python 2 and notice the errors. Add wrappers from
<code class="docutils literal notranslate"><span class="pre">future</span></code> to re-enable Python 2 compatibility. See the
<a class="reference internal" href="compatible_idioms.html#compatible-idioms"><span class="std std-ref">Cheat Sheet: Writing Python 2-3 compatible code</span></a> cheat sheet and <a class="reference internal" href="what_else.html#what-else"><span class="std std-ref">What else you need to know</span></a> for more info.</p>
<p>After each change, re-run the tests on Py3 and Py2 to ensure they pass on both.</p>
<p><strong>2e</strong>. You’re done! Celebrate! Push your code and announce to the world! Hashtags
#python3 #python-future.</p>
</section>
</section>
<section id="pasteurize-py3-to-py2-3">
<span id="backwards-conversion"></span><h2><code class="docutils literal notranslate"><span class="pre">pasteurize</span></code>: Py3 to Py2/3<a class="headerlink" href="#pasteurize-py3-to-py2-3" title="Link to this heading">¶</a></h2>
<p>Running <code class="docutils literal notranslate"><span class="pre">pasteurize</span> <span class="pre">-w</span> <span class="pre">mypy3module.py</span></code> turns this Python 3 code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">copyreg</span>

<span class="k">class</span> <span class="nc">Blah</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>into this code which runs on both Py2 and Py3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="n">standard_library</span><span class="o">.</span><span class="n">install_hooks</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">copyreg</span>

<span class="k">class</span> <span class="nc">Blah</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that both <code class="docutils literal notranslate"><span class="pre">futurize</span></code> and <code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> create explicit new-style
classes that inherit from <code class="docutils literal notranslate"><span class="pre">object</span></code> on both Python versions, and both
refer to stdlib modules (as well as builtins) under their Py3 names.</p>
<p>Note also that the <code class="docutils literal notranslate"><span class="pre">configparser</span></code> module is a special case; there is a full
backport available on PyPI (<a class="reference external" href="https://pypi.org/project/configparser/">https://pypi.org/project/configparser/</a>), so, as
of v0.16.0, <code class="docutils literal notranslate"><span class="pre">python-future</span></code> no longer provides a <code class="docutils literal notranslate"><span class="pre">configparser</span></code> package
alias. To use the resulting code on Py2, install the <code class="docutils literal notranslate"><span class="pre">configparser</span></code> backport
with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">configparser</span></code> or by adding it to your <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>
file.</p>
<p><code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> also handles the following Python 3 features:</p>
<ul class="simple">
<li><p>keyword-only arguments</p></li>
<li><p>metaclasses (using <a class="reference internal" href="reference.html#future.utils.with_metaclass" title="future.utils.with_metaclass"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_metaclass()</span></code></a>)</p></li>
<li><p>extended tuple unpacking (PEP 3132)</p></li>
</ul>
<p>To handle function annotations (PEP 3107), see <a class="reference internal" href="func_annotations.html#func-annotations"><span class="std std-ref">Function annotations</span></a>.</p>
</section>
<section id="known-limitations">
<span id="futurize-limitations"></span><h2>Known limitations<a class="headerlink" href="#known-limitations" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">futurize</span></code> and <code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> are useful to automate much of the
work of porting, particularly the boring repetitive text substitutions. They also
help to flag which parts of the code require attention.</p>
<p>Nevertheless, <code class="docutils literal notranslate"><span class="pre">futurize</span></code> and <code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> are still incomplete and make
some mistakes, like 2to3, on which they are based. Please report bugs on
<a class="reference external" href="https://github.com/PythonCharmers/python-future/">GitHub</a>. Contributions to
the <code class="docutils literal notranslate"><span class="pre">lib2to3</span></code>-based fixers for <code class="docutils literal notranslate"><span class="pre">futurize</span></code> and <code class="docutils literal notranslate"><span class="pre">pasteurize</span></code> are
particularly welcome! Please see <a class="reference internal" href="faq.html#contributing"><span class="std std-ref">Contributing</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">futurize</span></code> doesn’t currently make the following change automatically:</p>
<ol class="arabic">
<li><p>Strings containing <code class="docutils literal notranslate"><span class="pre">\U</span></code> produce a <code class="docutils literal notranslate"><span class="pre">SyntaxError</span></code> on Python 3. An example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;C:\Users&#39;</span><span class="o">.</span>
</pre></div>
</div>
<p>Python 2 expands this to <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">'C:\\Users'</span></code>, but Python 3 requires a raw
prefix (<code class="docutils literal notranslate"><span class="pre">r'...'</span></code>). This also applies to multi-line strings (including
multi-line docstrings).</p>
</li>
</ol>
<p>Also see the tests in <code class="docutils literal notranslate"><span class="pre">future/tests/test_futurize.py</span></code> marked
<code class="docutils literal notranslate"><span class="pre">&#64;expectedFailure</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;skip</span></code> for known limitations.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
  <span id="sidebar-top"></span>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  
    
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/python-future-logo-textless-transparent.png" alt="Logo"/>
            </a></p>
  
<!--<h3>Python-Future</h3>
<p>-->
  <h4>Easy, clean, reliable Python 2/3 compatibility</h4>
  <a href="https://python-future.org/#contents">Table of Contents</a>
<!--
</p>
<h3>Other Formats</h3>
<p>
  You can download the documentation in other formats as well:
</p>
<ul>
  <li><a href="http://jinja.pocoo.org/docs/jinja-docs.pdf">as PDF</a>
  <li><a href="http://jinja.pocoo.org/docs/jinja-docs.zip">as zipped HTML</a>
</ul>
-->
<!--<h3>Useful Links</h3>
<ul>
  <li><a href="https://pypi.org/project/future/">on PyPI</a></li>
  <li><a href="https://github.com/PythonCharmers/python-future">on GitHub</a></li>
</ul>
--><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What’s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview: Easy, clean, reliable Python 2/3 compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick-start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="compatible_idioms.html">Cheat Sheet: Writing Python 2-3 compatible code</a></li>
<li class="toctree-l1"><a class="reference internal" href="imports.html">Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_else.html">What else you need to know</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Automatic conversion to Py2/3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#futurize-py2-to-py2-3"><code class="docutils literal notranslate"><span class="pre">futurize</span></code>: Py2 to Py2/3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#futurize-quick-start-guide"><code class="docutils literal notranslate"><span class="pre">futurize</span></code> quick-start guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pasteurize-py3-to-py2-3"><code class="docutils literal notranslate"><span class="pre">pasteurize</span></code>: Py3 to Py2/3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#known-limitations">Known limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="stdlib_incompatibilities.html">Standard library incompatibilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="older_interfaces.html">Older interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changes in previous versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Licensing and credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API Reference (in progress)</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>

  
    <div class="footer" role="contentinfo">
    &#169; Copyright 2013-2019, Python Charmers Pty Ltd, Australia.
    </div>
  <script src="_static/version_warning_offset.js"></script>

<div class="footer">
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>